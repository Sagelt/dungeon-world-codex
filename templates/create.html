{% extends 'base/two-column-base.html' %}

{% macro checkbox(name, value, text) -%}

{%- endmacro %}

{% macro radio(name, value, text) -%}
<p><input type="radio" name="{{ name }}" value="{{ value }}" />{{ text }}</p>
{%- endmacro %}

{% macro RenderQuestion(question, context="", header="h3") -%}
<{{header}}>{{ question.prompt }}</{{header}}>
{% if question.expectsShortText  %}
    <input type="text" name="{% if context %}{{context}}{% endif %}{{ question.order }}" autocomplete="off"/>
{% elif question.expectsOne %}
	{% for option in question.options.items() %}
		{{ radio(question.order, loop.index0, option[0]) }}
		{% if option[1].subquestions %}
			{% set curoption = loop.index0 ~ ""%}
			{% for subquestion in option[1].subquestions.items() %}
				{% set inheritcontext = context ~ question.order ~ "." ~ curoption ~ "-" %}
				{{ RenderQuestion(subquestion[1], context=inheritcontext, header="p") }}
			{% endfor %}
		{% endif %}
	{% endfor %}
{% elif question.expectsMultiple %}
	{% for option in question.options.items() %}
		{% set divid = question.order ~ "-" ~ loop.index0 %}
		<p><input type="checkbox" name="{{ question.order }}.{{ loop.index0 }}" value="1" onchange="toggle('{{ divid }}')"/>{{ option[0] }}</p>
		{% if option[1].subquestions %}
			{% set divid = question.order ~ "-" ~ loop.index0 %}
			<div id="{{ divid }}" style="display: none">
			{% set curoption = loop.index0 ~ ""%}
			{% for subquestion in option[1].subquestions.items() %}
				{% set inheritcontext = context ~ question.order ~ "." ~ curoption ~ "-" %}
				{{ RenderQuestion(subquestion[1], context=inheritcontext, header="p") }}
			{% endfor %}
			</div>
		{% endif %}
	{% endfor %}
{% elif question.expectsLongText %}
	<textarea name="{{ question.order }}" rows="10" cols="100" ></textarea>
{% else %}
     <p>Invalid question type</p>
{% endif %}
{%- endmacro %}


{% block title %}Dungeon World Monster Maker{% endblock title %}
{% block left %}
	{% if profile %}
		<form name="input" method="post">
			<script language="javascript"> 
			function toggle(showHideDiv) {
				var ele = document.getElementById(showHideDiv);
				if(ele.style.display == "block") {
			    	ele.style.display = "none";
			  	}
				else {
					ele.style.display = "block";
				}
			} 
			</script>
		    {% for question in questions %}
		        {{ RenderQuestion(question) }}
		    {% endfor %}
		    <input type="submit" value="Create" />
		</form>
	{% else %}
		<h1>Login Required</h1>
		<p>You have to <a href="{{ login_url }}">log in</a> to make a monster.</p>
	{% endif %}
{% endblock left %}
